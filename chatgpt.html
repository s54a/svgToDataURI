<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>SVG → Favicon Data URI</title>

    <!-- DEFAULT FAVICON (ALWAYS PRESENT) -->
    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,%3Csvg%20width%3D%2232%22%20height%3D%2232%22%20viewBox%3D%220%200%2032%2032%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%20%3C!--%20Background%20--%3E%20%3Crect%20x%3D%220%22%20y%3D%220%22%20width%3D%2232%22%20height%3D%2232%22%20rx%3D%228%22%20fill%3D%22%232563EB%22%20%2F%3E%20%3C!--%20Lightning%20Icon%20--%3E%20%3Cpath%20d%3D%22M17%2013V6L8%2017h7v7l9-11h-7z%22%20fill%3D%22none%22%20stroke%3D%22white%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%20%2F%3E%20%3C!--%20Glow%20--%3E%20%3Cdefs%3E%20%3Cfilter%20id%3D%22glow%22%3E%20%3CfeDropShadow%20dx%3D%220%22%20dy%3D%220%22%20stdDeviation%3D%226%22%20flood-color%3D%22rgba(37%2C99%2C235%2C0.5)%22%20%2F%3E%20%3C%2Ffilter%3E%20%3C%2Fdefs%3E%20%3Crect%20x%3D%220%22%20y%3D%220%22%20width%3D%2232%22%20height%3D%2232%22%20rx%3D%228%22%20fill%3D%22transparent%22%20filter%3D%22url(%23glow)%22%20%2F%3E%3C%2Fsvg%3E"
    />
    <link rel="stylesheet" href="./src/style.css" />

    <style>
      :root {
        --bg: #020617;
        --panel: #020617;
        --card: #020617;
        --border: #1e293b;
        --muted: #94a3b8;
        --text: #e5e7eb;
        --accent: #38bdf8;
        --accent-2: #22c55e;
        --danger: #ef4444;
        --radius: 14px;
      }

      * {
        box-sizing: border-box;
        font-family:
          ui-sans-serif,
          system-ui,
          -apple-system,
          Segoe UI,
          Roboto;
      }

      body {
        margin: 0;
        background:
          radial-gradient(1200px 600px at 10% -20%, #020617, transparent),
          radial-gradient(1200px 600px at 90% 120%, #020617, transparent),
          var(--bg);
        color: var(--text);
        min-height: 100vh;
        padding: 40px;
      }

      h1 {
        font-size: 24px;
        margin-bottom: 6px;
        letter-spacing: -0.02em;
      }

      p.sub {
        color: var(--muted);
        margin-top: 0;
        margin-bottom: 24px;
        font-size: 14px;
      }

      .grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
      }

      .card {
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.02),
          rgba(255, 255, 255, 0)
        );
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 16px;
        box-shadow: 0 0 0 1px rgba(255, 255, 255, 0.02) inset;
      }

      .card h2 {
        font-size: 14px;
        margin: 0 0 10px;
        color: #f8fafc;
        font-weight: 600;
      }

      textarea,
      input {
        width: 100%;
        background: #020617;
        border: 1px solid var(--border);
        color: var(--text);
        padding: 10px;
        border-radius: 10px;
        outline: none;
        resize: vertical;
        font-size: 13px;
      }

      textarea {
        min-height: 140px;
        line-height: 1.5;
      }

      input::placeholder,
      textarea::placeholder {
        color: var(--muted);
      }

      .actions {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-top: 12px;
      }

      button {
        background: #020617;
        border: 1px solid var(--border);
        color: var(--text);
        padding: 8px 14px;
        border-radius: 10px;
        cursor: pointer;
        font-size: 13px;
        transition: all 0.15s ease;
      }

      button:hover {
        border-color: var(--accent);
        color: var(--accent);
      }

      button.primary {
        border-color: var(--accent);
        color: var(--accent);
      }

      button.success {
        border-color: var(--accent-2);
        color: var(--accent-2);
      }

      button.danger {
        border-color: var(--danger);
        color: var(--danger);
      }

      .output {
        font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
        font-size: 12px;
        white-space: pre-wrap;
        word-break: break-all;
      }

      .saved {
        max-height: 220px;
        overflow-y: auto;
        font-size: 12px;
        margin-top: 10px;
        color: var(--muted);
      }

      .saved div {
        padding: 6px 0;
        border-bottom: 1px dashed var(--border);
      }

      footer {
        margin-top: 30px;
        font-size: 12px;
        color: var(--muted);
        text-align: center;
      }

      @media (max-width: 900px) {
        .grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <nav class="sticky top-0 z-50 border-b backdrop-blur-md">
      <div class="mx-auto flex h-16 w-full items-center justify-between px-4">
        <div class="flex items-center gap-3">
          <div
            class="flex h-8 w-8 items-center justify-center rounded-lg bg-blue-600 shadow-[0_0_15px_-3px_rgba(37,99,235,0.5)] ring-1 ring-white/10"
          >
            <svg
              class="6 h-5 w-5 text-white"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M13 10V3L4 14h7v7l9-11h-7z"
              />
            </svg>
          </div>
          <span class="text-lg font-bold tracking-tight"
            >Favicon<span class="text-blue-500">Gen</span></span
          >
        </div>

        <div class="flex items-center gap-6 text-sm font-medium text-zinc-400">
          <a href="./index.html" class="transition-colors hover:text-white">
            Gemini Version
          </a>
          <a href="./claude.html" class="transition-colors hover:text-white">
            Claude Version
          </a>
          <a href="./chatgpt.html" class="transition-colors hover:text-white">
            ChatGPT Version</a
          >
          <a
            href="https://github.com/s54a/svgToDataURI"
            target="_blank"
            class="hidden items-center gap-2 transition-colors hover:text-white sm:flex"
          >
            <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 24 24">
              <path
                d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"
              />
            </svg>
            GitHub
          </a>
        </div>
      </div>
    </nav>

    <h1 class="mt-8">SVG → Favicon Data URI</h1>
    <p class="sub">
      Paste SVG markup, paste from clipboard, or fetch SVG URL. Output is
      favicon-ready. Saved locally. Exportable as JSON.
    </p>

    <div class="grid">
      <!-- INPUT -->
      <div class="card">
        <h2>SVG Input</h2>

        <input
          id="svgUrl"
          class="mb-4"
          placeholder="Optional: SVG URL (https://...)"
        />

        <textarea id="svgInput" placeholder="Paste SVG markup here…"></textarea>

        <div class="actions">
          <button class="primary" onclick="convert()">Convert</button>
          <button onclick="pasteFromClipboard()">Paste from Clipboard</button>
          <button onclick="fetchFromUrl()">Fetch URL</button>
          <button class="danger" onclick="clearInput()">Clear</button>
        </div>
      </div>

      <!-- OUTPUT -->
      <div class="card">
        <h2>Favicon Output</h2>

        <textarea
          id="output"
          class="output"
          placeholder="Converted favicon link will appear here…"
        ></textarea>

        <div class="actions">
          <button class="success" onclick="copyOutput()">Copy</button>
          <button onclick="saveEntry()">Save</button>
          <button onclick="exportJSON()">Export JSON</button>
          <button class="danger" onclick="clearStorage()">Clear Saved</button>
        </div>

        <div class="saved" id="savedList"></div>
      </div>
    </div>

    <footer>Local only. No network calls except optional SVG fetch.</footer>

    <script>
      const STORAGE_KEY = "svg_favicon_history";

      function encodeSVG(svg) {
        return svg
          .replace(/\s+/g, " ")
          .replace(/"/g, "'")
          .replace(/%/g, "%25")
          .replace(/#/g, "%23")
          .replace(/</g, "%3C")
          .replace(/>/g, "%3E")
          .replace(/\{/g, "%7B")
          .replace(/\}/g, "%7D")
          .replace(/\|/g, "%7C")
          .replace(/\^/g, "%5E")
          .replace(/`/g, "%60")
          .replace(/;/g, "%3B")
          .replace(/\?/g, "%3F")
          .replace(/:/g, "%3A")
          .replace(/@/g, "%40")
          .replace(/=/g, "%3D")
          .replace(/&/g, "%26");
      }

      function convert() {
        const raw = document.getElementById("svgInput").value.trim();
        if (!raw.startsWith("<svg")) {
          alert("Invalid SVG markup");
          return;
        }

        const encoded = encodeSVG(raw);
        const link = `<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,${encoded}">`;

        document.getElementById("output").value = link;
      }

      async function pasteFromClipboard() {
        try {
          const text = await navigator.clipboard.readText();
          document.getElementById("svgInput").value = text;
        } catch {
          alert("Clipboard access denied");
        }
      }

      async function fetchFromUrl() {
        const url = document.getElementById("svgUrl").value.trim();
        if (!url) return;

        try {
          const res = await fetch(url);
          const text = await res.text();
          document.getElementById("svgInput").value = text;
        } catch {
          alert("Failed to fetch SVG");
        }
      }

      function copyOutput() {
        navigator.clipboard.writeText(document.getElementById("output").value);
      }

      function saveEntry() {
        const svg = document.getElementById("svgInput").value;
        const out = document.getElementById("output").value;
        if (!svg || !out) return;

        const data = loadStorage();
        data.push({
          svg,
          output: out,
          ts: new Date().toISOString(),
        });

        localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        renderSaved();
      }

      function loadStorage() {
        return JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
      }

      function renderSaved() {
        const list = document.getElementById("savedList");
        const data = loadStorage();
        list.innerHTML = "";

        data
          .slice()
          .reverse()
          .forEach((item) => {
            const div = document.createElement("div");
            div.textContent = item.output.slice(0, 120) + "…";
            list.appendChild(div);
          });
      }

      function exportJSON() {
        const data = loadStorage();
        const blob = new Blob([JSON.stringify(data, null, 2)], {
          type: "application/json",
        });
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "svg-favicons.json";
        a.click();
      }

      function clearStorage() {
        localStorage.removeItem(STORAGE_KEY);
        renderSaved();
      }

      function clearInput() {
        document.getElementById("svgInput").value = "";
        document.getElementById("output").value = "";
        document.getElementById("svgUrl").value = "";
      }

      renderSaved();
    </script>
  </body>
</html>
